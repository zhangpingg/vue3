{"version":3,"file":"index-C7PM285c.js","sources":["../../src/pages/imgLazyLoad/components/LoadingLazyDemo.vue","../../src/pages/imgLazyLoad/components/IntersectionObserverDemo.vue"],"sourcesContent":["<template>\r\n    <div class=\"box\">\r\n        <h1>图片懒加载</h1>\r\n        <div v-for=\"(item, index) in imageList\" :key=\"index\" class=\"box-item\">\r\n            <img\r\n                :src=\"item.url\"\r\n                style=\"width: 100%; height: 400px\"\r\n                @load=\"imgLoadSuccess(index)\"\r\n                @error=\"imgLoadError(index)\"\r\n                loading=\"lazy\"\r\n            />\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from 'vue';\r\n\r\nconst imageList = ref([\r\n    { url: 'https://picsum.photos/800/400?random=1', loaded: false },\r\n    { url: 'https://picsum.photos/800/400?random=2', loaded: false },\r\n    { url: 'https://picsum.photos/800/400?random=3', loaded: false },\r\n    { url: 'https://picsum.photos/800/400?random=4', loaded: false },\r\n    { url: 'https://picsum.photos/800/400?random=5', loaded: false },\r\n    { url: 'https://picsum.photos/800/400?random=6', loaded: false },\r\n    { url: 'https://picsum.photos/800/400?random=7', loaded: false },\r\n    { url: 'https://picsum.photos/800/400?random=8', loaded: false },\r\n    { url: 'https://picsum.photos/800/400?random=9', loaded: false },\r\n    { url: 'https://picsum.photos/800/400?random=10', loaded: false }\r\n]);\r\n\r\n// 图片加载成功\r\nconst imgLoadSuccess = (index) => {\r\n    console.log(`图片 ${index + 1} 加载成功`);\r\n    imageList.value[index].loaded = true;\r\n};\r\n// 图片加载失败\r\nconst imgLoadError = (index) => {\r\n    console.error(`图片 ${index + 1} 加载失败`);\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.box {\r\n    width: 600px;\r\n    padding: 20px;\r\n    border: 1px solid #000;\r\n    .box-item {\r\n        border-radius: 8px;\r\n        background: #f0f0f0;\r\n        margin-top: 20px;\r\n    }\r\n}\r\n</style>\r\n","<template>\r\n    <div class=\"box\">\r\n        <h1>图片懒加载</h1>\r\n        <div v-for=\"(item, index) in imageList\" :key=\"index\" class=\"box-item\">\r\n            <img\r\n                :src=\"item.loaded ? item.url : ''\"\r\n                :data-index=\"index\"\r\n                :data-src=\"item.url\"\r\n                class=\"imglazyLoad\"\r\n                style=\"width: 100%; height: 400px\"\r\n                @load=\"imgLoadSuccess(index)\"\r\n                @error=\"imgLoadError(index)\"\r\n            />\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, onUnmounted } from 'vue';\r\n\r\nconst observerRef = ref();\r\nconst imageList = ref([\r\n    { url: 'https://picsum.photos/800/400?random=1', loaded: false },\r\n    { url: 'https://picsum.photos/800/400?random=2', loaded: false },\r\n    { url: 'https://picsum.photos/800/400?random=3', loaded: false },\r\n    { url: 'https://picsum.photos/800/400?random=4', loaded: false },\r\n    { url: 'https://picsum.photos/800/400?random=5', loaded: false },\r\n    { url: 'https://picsum.photos/800/400?random=6', loaded: false },\r\n    { url: 'https://picsum.photos/800/400?random=7', loaded: false },\r\n    { url: 'https://picsum.photos/800/400?random=8', loaded: false },\r\n    { url: 'https://picsum.photos/800/400?random=9', loaded: false },\r\n    { url: 'https://picsum.photos/800/400?random=10', loaded: false }\r\n]);\r\n\r\n// 初始化图片观察者\r\nconst initImgObserver = () => {\r\n    observerRef.value = new IntersectionObserver(\r\n        (entries, observer) => {\r\n            // entries是一个数组，包含所有被观察的元素的状态信息\r\n            entries.forEach((entry) => {\r\n                if (entry.isIntersecting) {\r\n                    const img = entry.target;\r\n                    img.src = img.dataset.src; // 自定义属性\r\n                    imageList.value[Number(img.dataset.index)].loaded = true;\r\n                    img.classList.remove('imglazyLoad');\r\n                    observer.unobserve(img); // 断开观察\r\n                }\r\n            });\r\n        },\r\n        {\r\n            root: null, // 指定监听的根元素（即视口）, 默认为浏览器视口\r\n            rootMargin: '200px', // 基于视口扩散或收缩的距离，默认为'0px'\r\n            threshold: 0.1 // 指定目标元素与根元素的交叉比例达到多少时触发\r\n        }\r\n    );\r\n    const imageDomList = document.querySelectorAll('.imglazyLoad');\r\n    imageDomList.forEach((img) => {\r\n        observerRef.value.observe(img); // 触发观察\r\n    });\r\n};\r\n// 图片加载成功\r\nconst imgLoadSuccess = (index) => {\r\n    console.log(`图片 ${index + 1} 加载成功`);\r\n};\r\n// 图片加载失败\r\nconst imgLoadError = (index) => {\r\n    console.error(`图片 ${index + 1} 加载失败`);\r\n};\r\n\r\nonMounted(() => {\r\n    initImgObserver();\r\n});\r\nonUnmounted(() => {\r\n    if (observerRef.value) {\r\n        observerRef.value.disconnect(); // 停止对所有目标元素的观察，防止内存泄漏和不必要的性能消耗\r\n        observerRef.value = null;\r\n    }\r\n});\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.box {\r\n    width: 600px;\r\n    padding: 20px;\r\n    border: 1px solid #000;\r\n    .box-item {\r\n        border-radius: 8px;\r\n        background: #f0f0f0;\r\n        margin-top: 20px;\r\n    }\r\n}\r\n</style>\r\n"],"names":["imageList","ref","imgLoadSuccess","index","imgLoadError","observerRef","initImgObserver","entries","observer","entry","img","onMounted","onUnmounted"],"mappings":"6RAkBA,MAAMA,EAAYC,EAAI,CAClB,CAAE,IAAK,yCAA0C,OAAQ,EAAO,EAChE,CAAE,IAAK,yCAA0C,OAAQ,EAAO,EAChE,CAAE,IAAK,yCAA0C,OAAQ,EAAO,EAChE,CAAE,IAAK,yCAA0C,OAAQ,EAAO,EAChE,CAAE,IAAK,yCAA0C,OAAQ,EAAO,EAChE,CAAE,IAAK,yCAA0C,OAAQ,EAAO,EAChE,CAAE,IAAK,yCAA0C,OAAQ,EAAO,EAChE,CAAE,IAAK,yCAA0C,OAAQ,EAAO,EAChE,CAAE,IAAK,yCAA0C,OAAQ,EAAO,EAChE,CAAE,IAAK,0CAA2C,OAAQ,EAAO,CACrE,CAAC,EAGKC,EAAkBC,GAAU,CAC9B,QAAQ,IAAI,MAAMA,EAAQ,CAAC,OAAO,EAClCH,EAAU,MAAMG,CAAK,EAAE,OAAS,EACpC,EAEMC,EAAgBD,GAAU,CAC5B,QAAQ,MAAM,MAAMA,EAAQ,CAAC,OAAO,CACxC,8cCnBA,MAAME,EAAcJ,EAAG,EACjBD,EAAYC,EAAI,CAClB,CAAE,IAAK,yCAA0C,OAAQ,EAAO,EAChE,CAAE,IAAK,yCAA0C,OAAQ,EAAO,EAChE,CAAE,IAAK,yCAA0C,OAAQ,EAAO,EAChE,CAAE,IAAK,yCAA0C,OAAQ,EAAO,EAChE,CAAE,IAAK,yCAA0C,OAAQ,EAAO,EAChE,CAAE,IAAK,yCAA0C,OAAQ,EAAO,EAChE,CAAE,IAAK,yCAA0C,OAAQ,EAAO,EAChE,CAAE,IAAK,yCAA0C,OAAQ,EAAO,EAChE,CAAE,IAAK,yCAA0C,OAAQ,EAAO,EAChE,CAAE,IAAK,0CAA2C,OAAQ,EAAO,CACrE,CAAC,EAGKK,EAAkB,IAAM,CAC1BD,EAAY,MAAQ,IAAI,qBACpB,CAACE,EAASC,IAAa,CAEnBD,EAAQ,QAASE,GAAU,CACvB,GAAIA,EAAM,eAAgB,CACtB,MAAMC,EAAMD,EAAM,OAClBC,EAAI,IAAMA,EAAI,QAAQ,IACtBV,EAAU,MAAM,OAAOU,EAAI,QAAQ,KAAK,CAAC,EAAE,OAAS,GACpDA,EAAI,UAAU,OAAO,aAAa,EAClCF,EAAS,UAAUE,CAAG,CACzB,CACjB,CAAa,CACJ,EACD,CACI,KAAM,KACN,WAAY,QACZ,UAAW,EACd,CACT,EACyB,SAAS,iBAAiB,cAAc,EAChD,QAASA,GAAQ,CAC1BL,EAAY,MAAM,QAAQK,CAAG,CACrC,CAAK,CACL,EAEMR,EAAkBC,GAAU,CAC9B,QAAQ,IAAI,MAAMA,EAAQ,CAAC,OAAO,CACtC,EAEMC,EAAgBD,GAAU,CAC5B,QAAQ,MAAM,MAAMA,EAAQ,CAAC,OAAO,CACxC,EAEA,OAAAQ,EAAU,IAAM,CACZL,GACJ,CAAC,EACDM,EAAY,IAAM,CACVP,EAAY,QACZA,EAAY,MAAM,aAClBA,EAAY,MAAQ,KAE5B,CAAC"}